{"version":3,"sources":["webpack:///D:/project/fuintUniapp/components/goods-sku-popup/index.vue?551a","webpack:///D:/project/fuintUniapp/components/goods-sku-popup/index.vue?a7d4","webpack:///D:/project/fuintUniapp/components/goods-sku-popup/index.vue?ae7b","webpack:///D:/project/fuintUniapp/components/goods-sku-popup/index.vue?d5b3","uni-app:///components/goods-sku-popup/index.vue","webpack:///D:/project/fuintUniapp/components/goods-sku-popup/index.vue?2b04","webpack:///D:/project/fuintUniapp/components/goods-sku-popup/index.vue?5e9a"],"names":["name","components","NumberBox","props","value","Type","default","goodsId","action","noStockText","stockText","goodsIdName","skuIdName","skuListName","specListName","stockName","skuName","skuArrName","defaultSingleSkuName","mode","maskCloseAble","borderRadius","goodsThumbName","minBuyNum","maxBuyNum","stepBuyNum","customAction","priceColor","buyNowText","buyNowColor","buyNowBackgroundColor","addCartText","addCartColor","addCartBackgroundColor","disableStyle","activedStyle","btnStyle","showClose","closeImage","defaultStock","defaultPrice","data","complete","goodsInfo","isShow","initKey","shopItemInfo","selectArr","subIndex","selectShop","selectNum","outFoStock","mounted","that","vk","methods","init","findGoodsInfo","url","title","goods_id","success","updateGoodsInfo","Object","open","findGoodsInfoRun","close","moveHandle","skuClick","checkSelectShop","checkInpath","specList","checkItem","skuList","i","stockNum","items","arr","checkSelectComplete","addCart","buyNow","toast","uni","icon","getListItem","item","autoClickSku","filters","priceFilter","n","computed","watch"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8H;AAC9H;AACyD;AACL;AACsC;;;AAG1F;AACmK;AACnK,gBAAgB,6KAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,4FAAM;AACR,EAAE,qGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,gGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC3CA;AAAA;AAAA;AAAA;AAAkmB,CAAgB,+mBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACiFtnB;AACA;AAAA,eACA;EACAA;EACAC;IACAC;EACA;EACAC;IACA;IACAC;MACAC;MACAC;IACA;IACA;IACA;IACAC;MACAF;MACAC;IACA;IACA;IACAE;MACAH;MACAC;IACA;IACA;IACA;IACAG;MACAJ;MACAC;IACA;IACA;IACAI;MACAL;MACAC;IACA;IACA;IACAK;MACAN;MACAC;IACA;IACA;IACAM;MACAP;MACAC;IACA;IACA;IACAO;MACAR;MACAC;IACA;IACA;IACAQ;MACAT;MACAC;IACA;IACA;IACAS;MACAV;MACAC;IACA;IACA;IACAU;MACAX;MACAC;IACA;IACA;IACAW;MACAZ;MACAC;IACA;IACA;IACAY;MACAb;MACAC;IACA;IACA;IACAa;MACAd;MACAC;IACA;IACA;IACAc;MACAf;MACAC;IACA;IACA;IACAe;MACAhB;MACAC;IACA;IACA;IACAgB;MACAjB;MACAC;IACA;IACA;IACAiB;MACAlB;MACAC;IACA;IACA;IACAkB;MACAnB;MACAC;IACA;IACA;IACAmB;MACApB;MACAC;IACA;IACA;IACAoB;MACArB;MACAC;IACA;IACA;IACAqB;MACAtB;MACAC;IACA;IACA;IACAsB;MACAvB;MACAC;IACA;IACA;IACAuB;MACAxB;MACAC;IACA;IACA;IACAwB;MACAzB;MACAC;IACA;IACA;IACAyB;MACA1B;MACAC;IACA;IACA;IACA0B;MACA3B;MACAC;IACA;IACA;IACA2B;MACA5B;MACAC;IACA;IACA;IACA4B;MACA7B;MACAC;IACA;IACA;IACA6B;MACA9B;MACAC;IACA;IACA;IACA8B;MACA/B;MACAC;IACA;IACA;IACA+B;MACAhC;MACAC;IACA;IACA;IACAgC;MACAjC;MACAC;IACA;IACA;IACAiC;MACAlC;MACAC;IACA;IACA;IACAkC;MACAnC;MACAC;IACA;EACA;EACAmC;IACA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;IACA;EACA;EACAC;IACAC;IACAC;IACA;MACAD;IACA;EACA;EACAE;IACA;IACAC;MACA;MACAH;MACAA;MACAA;MACAA;MACAA;MACAA;MAEA;MACAA;QACAA;QACAA;MACA;MAEAA;MACAA;MACAA;IACA;IACA;IACAI;MACA;QACAJ;QACA;MACA;MACAC;QACAI;QACAC;QACAlB;UACAmB;QACA;QACAC;UACAR;QACA;MACA;IACA;IACA;IACAS;MACA;MACA;QACAT;QACAA;MACA;QACAA;MACA;MACA;QACAA;QACAA;MACA;MACA;MACA;MACAU;MACAV;MACAA;MACAA;IACA;IACAW;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAC;gBACApD;gBAAA,MACAwC;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OACAA;cAAA;gBAAAV;gBAAA,MACAA;kBAAA;kBAAA;gBAAA;gBACAsB;gBACAZ;gBAAA;gBAAA;cAAA;gBAEAA;gBACAA;gBAAA,iCACA;cAAA;gBAAA;gBAAA;cAAA;gBAGA;kBACAA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACA;IACAa;MACA;QACAb;QACAA;MACA;QACA;UACAA;UACAA;QACA;MACA;IACA;IACAc;MACA;IAAA,CACA;IACA;IACAC;MACA;QACA;UACAf;UACAA;QACA;UACAA;UACAA;QACA;QACAA;QACA;QACAA;MACA;IACA;IACA;IACAgB;MACA;MACA;QAAA;MAAA;QACAhB;QACAA;MACA;QACAA;MACA;IACA;IACA;IACAiB;MACA;MACA;MACA;MACA;MACA;QACA;UACA;QACA;QACA;QACA;UACA;YACA;UACA;UACA;UACAjB;UACA;YAAA;UAAA;UACA;YACAkB;UACA;YACAA;UACA;QACA;MACA;MACAlB;IACA;IACA;IACAmB;MACA;MACA;MACA;MACA;MACA;MACA;QACA;UACAC;UACAC;QACA;UACAC;QACA;MACA;MACA;QACAtB;MACA;MACA;MACA,4BACA;QACA,mBACAuB,8BACA;UACA,kBACAC;YACA;YACA;cACAxB;YACA;YACA;UACA,GACA;QACA,GACA,CACA,GACA,CACA,CACA;MACA,GACA,CACA,GACA,CACA;IACA;IACA;IACAyB;MAAA;MACA;MACA;QACA;QACA;UACA;QACA;UACAzB;QACA;MACA;QACAA;MACA;IACA;IACA;IACA0B;MACA1B;QACAQ;UACAZ;UACAI;QACA;MACA;IACA;IACA;IACA2B;MACA3B;QACAQ;UACAZ;UACAI;QACA;MACA;IACA;IACA;IACA4B;MACAC;QACAvB;QACAwB;MACA;IACA;IACA;IACAC;MACA;MACA;QACA;UACA;YACAC;YACA;UACA;QACA;UACA;YACAA;YACA;UACA;QACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MAEA;QACA;QAEA;UACA;UACA;YACAjC;YACA;UACA;QACA;MACA;IACA;EACA;EACA;EACAkC;IACA;IACAC;MAAA;MACA;QACAC;MACA;MACA;IACA;EACA;EACA;EACAC,WAEA;EACAC;IACAvF;MACA;QACAiD;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC7jBA;AAAA;AAAA;AAAA;AAAqqC,CAAgB,snCAAG,EAAC,C;;;;;;;;;;;ACAzrC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/goods-sku-popup/index.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=63515b46&scoped=true&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=63515b46&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"63515b46\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/goods-sku-popup/index.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=63515b46&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var f0 = _vm._f(\"priceFilter\")(_vm.selectShop.price || _vm.defaultPrice)\n  var g0 = _vm.selectArr.every(function (val) {\n    return val == \"\"\n  })\n  var g1 = !g0 ? _vm.selectArr.join(\" \") : null\n  var l1 = _vm.__map(_vm.goodsInfo[_vm.specListName], function (item, index1) {\n    var $orig = _vm.__get_orig(item)\n    var l0 = _vm.__map(item.list, function (item_value, index2) {\n      var $orig = _vm.__get_orig(item_value)\n      var s0 = _vm.__get_style([\n        item_value.ishow ? \"\" : _vm.disableStyle,\n        item_value.ishow ? _vm.btnStyle : \"\",\n        _vm.subIndex[index1] == index2 ? _vm.activedStyle : \"\",\n      ])\n      return {\n        $orig: $orig,\n        s0: s0,\n      }\n    })\n    return {\n      $orig: $orig,\n      l0: l0,\n    }\n  })\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        f0: f0,\n        g0: g0,\n        g1: g1,\n        l1: l1,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"goods-sku-popup popup\" catchtouchmove=\"true\" :class=\"(value && complete) ? 'show' : 'none'\"\n    @touchmove.stop.prevent=\"moveHandle\">\n    <!-- 页面内容开始 -->\n    <view class=\"mask\" @click=\"close('mask')\"></view>\n    <!-- 页面开始 -->\n    <view class=\"layer attr-content\" :style=\"'border-radius: '+borderRadius+'rpx '+borderRadius+'rpx 0 0;'\">\n      <view class=\"specification-wrapper\">\n        <scroll-view class=\"specification-wrapper-content\" scroll-y=\"true\">\n          <view class=\"specification-header\">\n            <view class=\"specification-left\">\n              <image class=\"product-img\" :src=\"selectShop.image ? selectShop.image : goodsInfo[goodsThumbName]\"\n                mode=\"aspectFill\"></image>\n            </view>\n            <view class=\"specification-right\">\n              <view class=\"price-content\" :style=\"'color: '+priceColor+' ;'\">\n                <text class=\"sign\">¥</text>\n                <text class=\"price\">{{ (selectShop.price || defaultPrice) | priceFilter }}</text>\n              </view>\n              <view class=\"inventory\">{{ stockText }}：{{ selectShop[stockName] || defaultStock }}</view>\n              <view class=\"choose\" v-show=\"goodsInfo[specListName] && goodsInfo[specListName][0].name !== defaultSingleSkuName\">\n                <text v-if=\"!selectArr.every(val => val == '')\">已选：{{ selectArr.join(' ') }}</text>\n              </view>\n            </view>\n          </view>\n\n          <view class=\"specification-content\">\n            <view v-show=\"goodsInfo[specListName][0].name !== defaultSingleSkuName\" class=\"specification-item\" v-for=\"(item, index1) in goodsInfo[specListName]\" :key=\"index1\">\r\n              <view class=\"item-title\">{{ item.name }}</view>\n              <view class=\"item-wrapper\">\n                <view class=\"item-content\" @tap=\"skuClick(item_value, index1, $event, index2)\" v-for=\"(item_value, index2) in item.list\"\n                  :key=\"index2\" :class=\"[item_value.ishow ? '' : 'noactived', subIndex[index1] == index2 ? 'actived' : '']\"\n                  :style=\"[item_value.ishow ? '' : disableStyle,\n                                                    item_value.ishow ? btnStyle :'',\n                                                    subIndex[index1] == index2 ? activedStyle : ''\n                                    ]\">\n                  {{ item_value.name }}\n                </view>\n              </view>\n            </view>\n            <view style=\"display: flex;\">\n              <view style=\"flex: 1;\">\n                <text style=\"font-size: 26rpx; color: #333; line-height: 50rpx;\">数量</text>\n              </view>\n              <view style=\"flex: 4;text-align: right;\">\n                <number-box :min=\"minBuyNum\" :max=\"maxBuyNum\" :step=\"stepBuyNum\" v-model=\"selectNum\"\n                  :positive-integer=\"true\">\n                </number-box>\n              </view>\n            </view>\n\n          </view>\n        </scroll-view>\n        <view class=\"close\" @click=\"close('close')\" v-if=\"showClose\">\n          <image class=\"close-item\" :src=\"closeImage\"></image>\n        </view>\n      </view>\n      <view class=\"btn-option\">\n          <view class=\"btn-wrapper\" v-if=\"outFoStock || mode == 4\">\n            <view class=\"sure\" style=\"color:#ffffff;background-color:#cccccc\">{{ noStockText }}</view>\n          </view>\n          <view class=\"btn-wrapper\" v-else-if=\"mode == 1\">\n            <view class=\"sure add-cart\" style=\"border-radius:38rpx 0rpx 0rpx 38rpx;\" @click=\"addCart\" :style=\"'color:'+addCartColor+';background:'+addCartBackgroundColor\">{{ addCartText }}</view>\n            <view class=\"sure\" style=\"border-radius:0rpx 38rpx 38rpx 0rpx;\" @click=\"buyNow\" :style=\"'color:'+buyNowColor+';background-color:'+buyNowBackgroundColor\">{{ buyNowText }}</view>\n          </view>\n          <view class=\"btn-wrapper\" v-else-if=\"mode == 2\">\n            <view class=\"sure add-cart\" @click=\"addCart\" :style=\"'color:'+addCartColor+';background:'+addCartBackgroundColor\">{{ addCartText }}</view>\n          </view>\n          <view class=\"btn-wrapper\" v-else-if=\"mode == 3\">\n            <view class=\"sure\" @click=\"buyNow\" :style=\"'color:'+buyNowColor+';background:'+buyNowBackgroundColor\">{{ buyNowText }}</view>\n          </view>\r\n      </view>\n      <!-- 页面结束 -->\n    </view>\n    <!-- 页面内容结束 -->\n  </view>\n</template>\n\n<script>\n  import NumberBox from './number-box'\n\n  var that; // 当前页面对象\n  var vk; // 自定义函数集\n  export default {\n    name: 'GoodsSkuPopup',\n    components: {\n      NumberBox\n    },\n    props: {\n      // true 组件显示 false 组件隐藏\n      value: {\n        Type: Boolean,\n        default: false\n      },\n      // vk云函数路由模式参数开始-----------------------------------------------------------\n      // 商品id\n      goodsId: {\n        Type: String,\n        default: \"\"\n      },\n      // vk路由模式框架下的云函数地址\n      action: {\n        Type: String,\n        default: \"\"\n      },\n      // vk云函数路由模式参数结束-----------------------------------------------------------\n      // 该商品已抢完时的按钮文字\n      noStockText: {\n        Type: String,\n        default: \"该商品已抢完\"\n      },\n      // 库存文字\n      stockText: {\n        Type: String,\n        default: \"库存\"\n      },\n      // 商品表id的字段名\n      goodsIdName: {\n        Type: String,\n        default: \"_id\"\n      },\n      // sku表id的字段名\n      skuIdName: {\n        Type: String,\n        default: \"_id\"\n      },\n      // sku_list的字段名\n      skuListName: {\n        Type: String,\n        default: \"sku_list\"\n      },\n      // spec_list的字段名\n      specListName: {\n        Type: String,\n        default: \"spec_list\"\n      },\n      // stock的字段名\n      stockName: {\n        Type: String,\n        default: \"stock\"\n      },\n      // sku_name的字段名\n      skuName: {\n        Type: String,\n        default: \"sku_name\"\n      },\n      // sku组合路径的字段名\n      skuArrName: {\n        Type: String,\n        default: \"sku_name_arr\"\n      },\n      // 默认单规格时的规格组名称\n      defaultSingleSkuName: {\n        Type: String,\n        default: \"默认\"\n      },\n      // 模式 1:都显示  2:只显示购物车 3:只显示立即购买 4:显示缺货按钮 默认 1\n      mode: {\n        Type: Number,\n        default: 1\n      },\n      // 点击遮罩是否关闭组件 true 关闭 false 不关闭 默认true\n      maskCloseAble: {\n        Type: Boolean,\n        default: true\n      },\n      // 顶部圆角值\n      borderRadius: {\n        Type: [String, Number],\n        default: 0\n      },\n      // 商品缩略图字段名(未选择sku时)\n      goodsThumbName: {\n        Type: [String],\n        default: \"goods_thumb\"\n      },\n      // 最小购买数量\n      minBuyNum: {\n        Type: Number,\n        default: 1\n      },\n      // 最大购买数量\n      maxBuyNum: {\n        Type: Number,\n        default: 100000\n      },\n      // 每次点击后的数量\n      stepBuyNum: {\n        Type: Number,\n        default: 1\n      },\n      // 自定义获取商品信息的函数\n      customAction: {\n        Type: [Function],\n        default: null\n      },\n      // 价格的字体颜色\n      priceColor: {\n        Type: String,\n        default: \"#fe560a\"\n      },\n      // 立即购买按钮的文字\n      buyNowText: {\n        Type: String,\n        default: \"立即购买\"\n      },\n      // 立即购买按钮的字体颜色\n      buyNowColor: {\n        Type: String,\n        default: \"#ffffff\"\n      },\n      // 立即购买按钮的背景颜色\n      buyNowBackgroundColor: {\n        Type: String,\n       default: \"linear-gradient(to right, $fuint-theme, $fuint-theme)\"\n      },\n      // 加入购物车按钮的文字\n      addCartText: {\n        Type: String,\n        default: \"加入购物车\"\n      },\n      // 加入购物车按钮的字体颜色\n      addCartColor: {\n        Type: String,\n        default: \"#ffffff\"\n      },\n      // 加入购物车按钮的背景颜色\n      addCartBackgroundColor: {\n        Type: String,\n        default: \"linear-gradient(to right, $fuint-theme, $fuint-theme)\"\n      },\n      // 不可点击时,按钮的样式\n      disableStyle: {\n        Type: Object,\n        default: null\n      },\n      // 按钮点击时的样式\n      activedStyle: {\n        Type: Object,\n        default: null\n      },\n      // 按钮常态的样式\n      btnStyle: {\n        Type: Object,\n        default: null\n      },\n      // 是否显示右上角关闭按钮\n      showClose: {\n        Type: Boolean,\n        default: true\n      },\n      // 关闭按钮的图片地址\n      closeImage: {\n        Type: String,\n        default: \"https://img.alicdn.com/imgextra/i1/121022687/O1CN01ImN0O11VigqwzpLiK_!!121022687.png\"\n      },\n      // 默认库存数量 (未选择sku时)\n      defaultStock: {\n        Type: Number,\n        default: 0\n      },\n      // 默认显示的价格 (未选择sku时)\n      defaultPrice: {\n        Type: Number,\n        default: 0\n      },\n    },\n    data() {\n      return {\n        complete: false, // 组件是否加载完成\n        goodsInfo: {}, // 商品信息\n        isShow: false, // true 显示 false 隐藏\n        initKey: true, // 是否已初始化\n        shopItemInfo: {}, // 存放要和选中的值进行匹配的数据\n        selectArr: [], // 存放被选中的值\n        subIndex: [], // 是否选中 因为不确定是多规格还是单规格，所以这里定义数组来判断\n        selectShop: {}, // 存放最后选中的商品\n        selectNum: this.minBuyNum, // 选中数量\n        outFoStock: false, // 是否全部sku都缺货\n      };\n    },\n    mounted() {\n      that = this;\n      vk = that.vk;\n      if (that.value) {\n          that.open();\n      }\n    },\n    methods: {\n      // 初始化\n      init() {\n        // 清空之前的数据\n        that.selectArr = [];\n        that.subIndex = [];\n        that.selectShop = {};\n        that.selectNum = that.minBuyNum;\n        that.outFoStock = false;\n        that.shopItemInfo = {};\n\n        let specListName = that.specListName;\n        that.goodsInfo[specListName].map(item => {\n             that.selectArr.push('');\n             that.subIndex.push(-1);\n        });\n\n        that.checkItem(); // 计算sku里面规格形成路径\n        that.checkInpath(-1); // 传-1是为了不跳过循环\n        that.autoClickSku(); // 自动选择sku策略\n      },\n      // 使用vk路由模式框架获取商品信息\n      findGoodsInfo() {\n        if (typeof vk == \"undefined\") {\n            that.toast(\"custom-action必须是function\");\n            return false;\n        }\n        vk.callFunction({\n          url: that.action,\n          title: '请求中...',\n          data: {\n            goods_id: that.goodsId\n          },\n          success(data) {\n            that.updateGoodsInfo(data.goodsInfo);\n          }\n        });\n      },\n      // 更新商品信息(库存、名称、图片)\n      updateGoodsInfo(goodsInfo) {\n        let skuListName = that.skuListName;\n        if (JSON.stringify(that.goodsInfo) === \"{}\" || that.goodsInfo[that.goodsIdName] !== goodsInfo[that.goodsIdName]) {\n            that.goodsInfo = goodsInfo;\n            that.initKey = true;\n        } else {\n            that.goodsInfo[skuListName] = goodsInfo[skuListName];\n        }\n        if (that.initKey) {\n            that.initKey = false;\n            that.init();\n        }\n        // 更新选中sku的库存信息\n        let select_sku_info = that.getListItem(that.goodsInfo[skuListName], that.skuIdName, that.selectShop[that.skuIdName]);\n        Object.assign(that.selectShop, select_sku_info);\n        that.complete = true;\n        that.$emit(\"open\", true);\n        that.$emit(\"input\", true);\n      },\n      async open() {\n        let findGoodsInfoRun = true;\n        let skuListName = that.skuListName;\n        if (that.customAction && typeof(that.customAction) === 'function') {\n          let goodsInfo = await that.customAction();\n          if (goodsInfo && typeof goodsInfo == \"object\" && JSON.stringify(goodsInfo) != \"{}\") {\n              findGoodsInfoRun = false;\n              that.updateGoodsInfo(goodsInfo);\n          } else {\n              that.toast(\"无法获取到商品信息\");\n              that.$emit(\"input\", false);\n              return false;\n          }\n        } else {\n          if (findGoodsInfoRun) {\n              that.findGoodsInfo();\n          }\n        }\n      },\n      // 监听 - 弹出层收起\n      close(s) {\n        if (s == \"close\") {\n          that.$emit(\"input\", false);\n          that.$emit(\"close\", \"close\");\n        } else if (s == \"mask\") {\n          if (that.maskCloseAble) {\n            that.$emit(\"input\", false);\n            that.$emit(\"close\", \"mask\");\n          }\n        }\n      },\n      moveHandle() {\n        //禁止父元素滑动\n      },\n      // sku按钮的点击事件\n      skuClick(value, index1, event, index2) {\n        if (value.ishow) {\n          if (that.selectArr[index1] != value.name) {\n              that.$set(that.selectArr, index1, value.name);\n              that.$set(that.subIndex, index1, index2);\n          } else {\n              that.$set(that.selectArr, index1, '');\n              that.$set(that.subIndex, index1, -1);\n          }\n          that.checkInpath(index1);\n          // 如果全部选完\n          that.checkSelectShop();\n        }\n      },\n      // 检测是否已经选完sku\n      checkSelectShop() {\n        // 如果全部选完\n        if (that.selectArr.every(item => item != '')) {\n            that.selectShop = that.shopItemInfo[that.selectArr];\n            that.selectNum = that.minBuyNum;\n        } else {\n            that.selectShop = {};\n        }\n      },\n      // 检查路径\n      checkInpath(clickIndex) {\n        let specListName = that.specListName;\n        //循环所有属性判断哪些属性可选\n        //当前选中的兄弟节点和已选中属性不需要循环\n        let specList = that.goodsInfo[specListName];\n        for (let i = 0, len = specList.length; i < len; i++) {\n          if (i == clickIndex) {\n              continue;\n          }\n          let len2 = specList[i].list.length;\n          for (let j = 0; j < len2; j++) {\n            if (that.subIndex[i] != -1 && j == that.subIndex[i]) {\n                continue;\n            }\n            let choosed_copy = [...that.selectArr];\n            that.$set(choosed_copy, i, specList[i].list[j].name);\n            let choosed_copy2 = choosed_copy.filter(item => item !== '' && typeof item !== 'undefined');\n            if (that.shopItemInfo.hasOwnProperty(choosed_copy2)) {\n                specList[i].list[j].ishow = true;\n            } else {\n                specList[i].list[j].ishow = false;\n            }\n          }\n        }\n        that.$set(that.goodsInfo, specListName, specList);\n      },\n      // 计算sku里面规格形成路径\n      checkItem() {\n        let skuListName = that.skuListName;\n        // console.time('计算有多小种可选路径需要的时间是');\n        // 去除库存小于等于0的商品sku\n        let skuList = that.goodsInfo[skuListName];\n        let stockNum = 0;\n        for (let i = 0; i < skuList.length; i++) {\n          if (skuList[i][that.stockName] <= 0) {\n              skuList.splice(i, 1);\n              i--;\n          } else {\n              stockNum += skuList[i][that.stockName];\n          }\n        }\n        if (stockNum <= 0) {\n            that.outFoStock = true;\n        }\n        // 计算有多小种可选路径\n        let result = skuList.reduce(\n          (arrs, items) => {\n            return arrs.concat(\n              items[that.skuArrName].reduce(\n                (arr, item) => {\n                  return arr.concat(\n                    arr.map(item2 => {\n                      // 利用对象属性的唯一性实现二维数组去重\n                      if (!that.shopItemInfo.hasOwnProperty([...item2, item])) {\n                          that.shopItemInfo[[...item2, item]] = items;\n                      }\n                      return [...item2, item];\n                    })\n                  );\n                },\n                [\n                  []\n                ]\n              )\n            );\n          },\n          [\n            []\n          ]\n        );\n      },\n      // 检测sku选项是否已全部选完,且有库存\n      checkSelectComplete(obj = {}) {\n        let selectShop = that.selectShop;\n        if (selectShop && selectShop[that.skuIdName] !== undefined) {\n          // 判断库存\n          if (that.selectNum <= selectShop[that.stockName]) {\n            if (typeof obj.success == \"function\") obj.success(selectShop);\n          } else {\n            that.toast(that.stockText + \"不足\", \"none\")\n          }\n        } else {\n          that.toast(\"请先选择对应规格\", \"none\");\n        }\n      },\n      // 加入购物车\n      addCart() {\n        that.checkSelectComplete({\n          success: function(selectShop) {\n            selectShop.buy_num = that.selectNum;\n            that.$emit(\"add-cart\", selectShop);\n          }\n        });\n      },\n      // 立即购买\n      buyNow() {\n        that.checkSelectComplete({\n          success: function(selectShop) {\n            selectShop.buy_num = that.selectNum;\n            that.$emit(\"buy-now\", selectShop);\n          }\n        });\n      },\n      // 弹窗\n      toast(title, icon) {\n        uni.showToast({\n          title: title,\n          icon: icon\n        });\n      },\n      // 获取对象数组中的某一个item,根据指定的键值\n      getListItem(list, key, value) {\n        let item;\n        for (let i in list) {\n          if (typeof value == \"object\") {\n            if (JSON.stringify(list[i][key]) === JSON.stringify(value)) {\n                item = list[i];\n                break;\n            }\n          } else {\n            if (list[i][key] === value) {\n                item = list[i];\n                break;\n            }\n          }\n        }\n        return item;\n      },\n      // 自动选择sku前提是只有一组sku,默认自动选择最前面的有库存的sku\n      autoClickSku() {\n        let skuList = that.goodsInfo[that.skuListName];\n        let specListArr = that.goodsInfo[that.specListName];\n        \n        if (specListArr.length == 1) {\n          let specList = specListArr[0].list;\n        \n          for (let i = 0; i < specList.length; i++) {\n            let sku = that.getListItem(skuList, that.skuArrName, [specList[i].name]);\n            if (sku) {\n                that.skuClick(specList[i], 0, {}, i);\n                break;\n            }\n          }\n        }\n      }\n    },\n    // 过滤器\n    filters: {\n      // 金额显示过滤器\n      priceFilter(n = 0) {\n        if (typeof n == \"string\") {\n            n = parseFloat(n)\n        }\n        return n ? n.toFixed(2) : n\n      }\n    },\n    // 计算属性\n    computed: {\n\n    },\n    watch: {\n      value: function(val) {\n        if (val) {\n            that.open();\n        }\n      },\n    }\n  };\n</script>\n\n<style lang=\"scss\" scoped>\n  /*  sku弹出层 */\n  .goods-sku-popup {\n    position: fixed;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 9999999999;\n    overflow: hidden;\n    &.show {\n      display: block;\n\n      .mask {\n        animation: showPopup 0.2s linear both;\n      }\n\n      .layer {\n        animation: showLayer 0.2s linear both;\n      }\n    }\n\n    &.hide {\n      .mask {\n        animation: hidePopup 0.2s linear both;\n      }\n\n      .layer {\n        animation: hideLayer 0.2s linear both;\n      }\n    }\n\n    &.none {\n      display: none;\n    }\n\n    .mask {\n      position: fixed;\n      top: 0;\n      width: 100%;\n      height: 100%;\n      z-index: 1;\n      background-color: rgba(0, 0, 0, 0.65);\n    }\n\n    .layer {\n      display: flex;\n      width: 100%;\n      max-height: 1200rpx;\r\n      flex-direction: column;\n      position: fixed;\n      z-index: 999999;\n      bottom: 0;\n      border-radius: 10rpx 10rpx 0 0;\n      background-color: #ffffff;\r\n      margin-top: 10rpx;\r\n      overflow-y: scroll;\r\n      .btn-option {\r\n          padding: 1rpx;\r\n          display: block;\r\n          clear: both;\r\n          margin-bottom: 60rpx;\r\n      }\n      .specification-wrapper {\n        width: 100%;\r\n        margin-top: 20rpx;\n        padding: 30rpx 25rpx;\n        box-sizing: border-box;\n        .specification-wrapper-content {\n          width: 100%;\n          min-height: 300rpx;\n\n          &::-webkit-scrollbar {\n            /*隐藏滚轮*/\n            display: none;\n          }\n\n          .specification-header {\n            width: 100%;\n            display: flex;\n            flex-direction: row;\n            position: relative;\n            margin-bottom: 40rpx;\n\n            .specification-left {\n              width: 180rpx;\n              height: 180rpx;\n              flex: 0 0 180rpx;\n\n              .product-img {\n                width: 180rpx;\n                height: 180rpx;\n                background-color: #999999;\n              }\n            }\n\n            .specification-right {\n              flex: 1;\n              padding: 0 35rpx 10rpx 28rpx;\n              box-sizing: border-box;\n              display: flex;\n              flex-direction: column;\n              justify-content: flex-end;\n              font-weight: 500;\n\n              .price-content {\n                color: #fe560a;\n                margin-bottom: 10rpx;\n\n                .sign {\n                  font-size: 28rpx;\n                  margin-right: 4rpx;\n                }\n\n                .price {\n                  font-size: 44rpx;\n                }\n              }\n\n              .inventory {\n                font-size: 24rpx;\n                color: #525252;\n                margin-bottom: 14rpx;\n              }\n\n              .choose {\n                font-size: 24rpx;\n                color: #525252;\n                min-height: 32rpx;\n              }\n            }\n          }\n\n          .specification-content {\n            font-weight: 500;\n            .specification-item {\n              margin-bottom: 40rpx;\n\n              &:last-child {\n                margin-bottom: 0;\n              }\n\n              .item-title {\n                margin-bottom: 15rpx;\n                font-size: 32rpx;\r\n                font-weight: bold;\n                color: #000000;\n              }\n\n              .item-wrapper {\n                display: flex;\n                flex-direction: row;\n                flex-flow: wrap;\n                margin-bottom: -20rpx;\n\n                .item-content {\n                  display: block;\n                  padding: 10rpx 20rpx;\r\n                  min-width: 110rpx;\r\n                  text-align: center;\n                  font-size: 24rpx;\n                  border-radius: 30rpx;\n                  background-color: #ffffff;\n                  color: #333333;\n                  margin-right: 20rpx;\n                  margin-bottom: 20rpx;\n                  border: 2rpx solid #cccccc;\n                  box-sizing: border-box;\n\n                  &.actived {\n                    border-color: #fe560a;\n                    color: #fe560a;\n                  }\n\n                  &.noactived {\n                    // background-color: #e4e4e4;\n                    // border-color: #e4e4e4;\n                    // color: #9e9e9e;\n                    // text-decoration: line-through;\n                    color: #c8c9cc;\n                    background: #f2f3f5;\n                    border-color: #f2f3f5;\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        .close {\n          position: absolute;\n          top: 30rpx;\n          right: 25rpx;\n          width: 50rpx;\n          height: 50rpx;\n          text-align: center;\n          line-height: 50rpx;\n\n          .close-item {\n            width: 40rpx;\n            height: 40rpx;\n          }\n        }\n      }\n\n      .btn-wrapper {\n        display: flex;\n        width: 100%;\n        height: 120rpx;\n        flex: 0 0 120rpx;\n        align-items: center;\n        justify-content: space-between;\n        padding: 0 26rpx;\n        box-sizing: border-box;\n\n        .layer-btn {\n          width: 335rpx;\n          height: 80rpx;\n          border-radius: 40rpx;\n          color: #fff;\n          line-height: 80rpx;\n          text-align: center;\n          font-weight: 500;\n          font-size: 28rpx;\n\n          &.add-cart {\n            background: #ffbe46;\n          }\n\n          &.buy {\n            background: #fe560a;\n          }\n        }\n\n        .sure {\n          width: 698rpx;\n          height: 80rpx;\n          border-radius: 38rpx;\n          color: #fff;\n          line-height: 80rpx;\n          text-align: center;\n          font-weight: 500;\n          font-size: 28rpx;\n          background: #fe560a;\n        }\n\n        .sure.add-cart {\n          background: $fuint-theme;\n        }\n      }\n    }\n\n    @keyframes showPopup {\n      0% {\n        opacity: 0;\n      }\n\n      100% {\n        opacity: 1;\n      }\n    }\n\n    @keyframes hidePopup {\n      0% {\n        opacity: 1;\n      }\n\n      100% {\n        opacity: 0;\n      }\n    }\n\n    @keyframes showLayer {\n      0% {\n        transform: translateY(120%);\n      }\n\n      100% {\n        transform: translateY(0%);\n      }\n    }\n\n    @keyframes hideLayer {\n      0% {\n        transform: translateY(0);\n      }\n\n      100% {\n        transform: translateY(120%);\n      }\n    }\n  }\n</style>\n","import mod from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=63515b46&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=63515b46&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1758976369581\n      var cssReload = require(\"D:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}